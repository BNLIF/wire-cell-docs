<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://BNLIF.github.io/wire-cell-docs/dev/iface/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Interfaces - Wire Cell Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Interfaces";
        var mkdocs_page_input_path = "dev/iface.md";
        var mkdocs_page_url = "/wire-cell-docs/dev/iface/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Wire Cell Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Overview</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Installation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../install/install/">Install Wire Cell</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../install/external/">Install Externals</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Developer</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev/">Building</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Interfaces</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../data/">Persistency</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../test/">Testing</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Algorithms</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../alg/cell/">Making Cells</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../alg/blob/">Blob Reconstruction</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Visualization</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../viz/bee/">Bee</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../viz/uploads/">User Uploads</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Meta</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../meta/meta/">About</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Wire Cell Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Developer</li>
      <li class="breadcrumb-item active">Interfaces</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/BNLIF/wire-cell-docs/edit/master/docs/dev/iface.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <p>Wire Cell uses Interfaces to access major components.</p>
<h1 id="overview-of-interfaces">Overview of Interfaces</h1>
<p>Wire Cell has a number of high-level concepts which are implemented as
C++ "Interface" classes.  Such classes expose only methods which take
or return either Plain Old Data (POD) or instances from the
<a href="https://github.com/BNLIF/wire-cell-data">Wire Cell Data</a> package.</p>
<p>The reason for this additional layer is to provide a decoupling
between the different Wire Cell packages and to allow one to set
actual implementations at the application layer.  This allows for
competing implementations to be swapped in a transparent manner.  For
example, one may have a wire geometry that comes from a parameterized
model that generates wire placements or one may have a detailed as-is
survey where each wire is painstakingly described and stored.  The
code that uses such a geometry doesn't care and instead accesses
whatever the application layer gives it via the <code>IWireGeometry</code>
interface.</p>
<p>A concrete implementation may present multiple interfaces.  For
example the <code>GeomDataSource</code> from the
<a href="https://github.com/BNLIF/wire-cell-nav">Wire Cell Nav</a> package
provides both <code>IWireGeometry</code> and <code>IWireDatabase</code> interfaces.</p>
<h1 id="providing-interfaces">Providing Interfaces</h1>
<p>Interface classes provide a mechanism to keep packages independent and
loosely coupled.  It does this by having code depend only on the
generic interface classes and not on the concrete implementations.  </p>
<p>It is possible (and easy) to violate paradigm and end up back with
tightly coupled packages and code.  This unwanted tight coupling can
still occur if the code that produces the concrete implementation of
an interface is intermixed with the code that consumes the interface.</p>
<p>To combat this one should layer the packages so that a higher
application layer is responsible for creating the concrete
implementations of interfaces as well as the consumer code (which may
also be accessed through interfaces).</p>
<p>Specifically, to maintain this separation one should place any
<code>apps/*.cxx</code> and <code>tests/*.cxx</code> main programs which create concrete
implementations of interfaces in a package other than the one that
holds the generic <code>src/*.cxx</code> library files.</p>
<h1 id="context">Context</h1>
<p>There are various important interfaces that most all of Wire Cell code
will require.  It is thus convenient to bundle access to these into a
single interface called the <code>IContext</code>.  This simplifies high-level
application code as the code for creating and initializing a specific
context can be provided as a high-level library.  For example, all
geometry and readout data may come from some domain.  One example is
if the input to Wire Cell originates from
<a href="https://github.com/BNLIF/wire-cell-sst">Wire Cell SST</a> files.
High-level application code can depend on SST, produce an SST-based
context and feed its content to the Wire Cell code as generic
interfaces.</p>
<h1 id="example">Example</h1>
<p>The figure below gives a hypothetical example.  At the top are the
Wire Cell interfaces.  In the middle are the concrete implementations
of these interfaces.  At the very bottom are (paradoxically)
high-level application components which aggregate concrete
implementations together in order to drive the program.  Shown is an
example of how Wire Cell and LArSoft might integrate.  A
<code>wire-cell-larsoft</code> component would provide concrete implementations
of Wire Cell interfaces using code that depends on facilities from
LArSoft.  A high-level (at the bottom) "application" (an Art module)
would tie together the interfaces implemented by LArSoft code and the
Wire Cell implementation in order to run in an Art job.</p>
<p><img alt="interface-dependency" src="../../img/interface-dependency.png" /></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../dev/" class="btn btn-neutral float-left" title="Building"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../data/" class="btn btn-neutral float-right" title="Persistency">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/BNLIF/wire-cell-docs/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../dev/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../data/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
